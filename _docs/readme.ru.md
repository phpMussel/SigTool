### Как установить:

Перед установкой, пожалуйста, проверьте требования. Если они не выполнены, SigTool не будет работать правильно.

#### Требования:
- PHP &gt;= `7.0.3` с поддержкой zlib + Phar.
- &gt;= 1ГБ свободного места на диске (если работает прямо с диска) или доступной ОЗУ (при использовании виртуальный оперативный диск; рекомендуемые).
- Возможность работы PHP в CLI-режиме (командная строка, терминал, оболочка, и т.д.).

Чтобы установить SigTool, просто скачайте `SigTool.php` и `YAML.php`. :-)

SigTool может нормально работать с диска или носителя информации так же, как и любой другой скрипт PHP. Однако из-за большого количества операций чтения/записи он выполняет, настоятельно рекомендуется использовать его с ОЗУ, поскольку это немного увеличит его скорость и уменьшит избыточные операции чтения/записи на диске. Конечный результат не должен превышать ~64МБ, но приблизительно ~1ГБ свободного дискового пространства или доступной ОЗУ требуется во время нормальной работы из-за временных рабочих файлов и во избежание ошибок чтения/записи.

---


### Как пользоваться:

Обратите внимание, что SigTool НЕ является веб-приложением! SigTool является CLI-приложение, предназначенное для использования с терминалом, оболочкой, и т.д. Его можно вызвать, вызвав двоичный файл PHP с файлом `SigTool.php` в качестве первого аргумента:

`$ php SigTool.php`

Справочная информация будет отображаться при вызове SigTool с указанием возможных флагов (второй аргумент), которые можно использовать при работе с SigTool.

Возможных флагов:
- Без аргументов: Показать эту справочную информацию.
- `x`: Извлечь файлы сигнатуры из `daily.cvd` и `main.cvd`.
- `p`: Обрабатывать файлы сигнатур для использования с phpMussel.
- `m`: Скачайте `main.cvd` перед обработкой.
- `d`: Скачайте `daily.cvd` перед обработкой.
- `u`: Обновление SigTool (загрузите `SigTool.php` заново и умирает; проверки не выполняются).

В результате получаются различные файлы сигнатур phpMussel, созданные непосредственно из базы данных сигнатур ClamAV, в двух формах:
- Файлы сигнатуры, которые можно вставить непосредственно в каталог `/vault/signatures/`.
- GZ-сжатые копии файлов сигнатур, которые можно использовать для обновления репозитория `phpMussel/Signatures`.

Файлы создаются непосредственно в том же каталоге, что и `SigTool.php`. Исходные файлы и все временные рабочие файлы будут удалены в процессе работы (поэтому, если вы хотите сохранить копии `daily.cvd` и `main.cvd`, вы должны сделать копии перед обработкой файлов сигнатуры).

При использовании SigTool для создания новых файлов сигнатур, антивирусный сканер вашего компьютера может попытаться удалить или поместить на карантин вновь созданные файлы сигнатур. Это происходит потому, что иногда файлы сигнатур могут содержать данные, очень похожие на данные, которые ваш антивирус ищет при сканировании. Тем не менее, файлы сигнатур, сгенерированные SigTool, не содержат исполняемого кода и абсолютно безопасны. Если вы столкнулись с этой проблемой, вы можете попытаться временно отключить антивирусный сканер или настроить антивирусный сканер для внесения в белый список каталога, в котором вы создаете новые файлы сигнатур.

Если при обработке файл YAML `signatures.dat` включен в тот же каталог, информация о версии и контрольные суммы будут обновлены соответственно (поэтому, при использовании SigTool для обновления репозитория `phpMussel/Signatures`, это должно быть включено).

*Примечание: Если вы являетесь пользователем phpMussel, помните, что файлы сигнатурей должны быть АКТИВНЫМИ, чтобы они работали правильно! Если вы используете SigTool для создания новых файлов сигнатур, вы можете «активировать» их, перечислив в директиве «Active» конфигурации phpMussel. Если вы используете страницу обновлений фронтенда для установки и обновления файлов сигнатур, вы можете «активировать» их непосредственно со страницы обновлений фронтенда. Однако использовать оба метода не обязательно. Кроме того, для оптимальной производительности, рекомендуется использовать только те файлы сигнатур, которые необходимы для вашей установки (например, если какой-то конкретный тип файла занесен в черный список, вам вероятно не понадобятся файлы сигнатуры, соответствующие этому типу; анализ файлов, которые все равно будут заблокированы, является излишней работой и может значительно замедлить процесс сканирования).*

Видео демонстрация использования SigTool доступна на YouTube: __[youtu.be/f2LfjY1HzRI](https://youtu.be/f2LfjY1HzRI)__

---


### Список сгенерированных SigTool файлов сигнатурей:
Файл сигнатуры | Описание
---|---
clamav.hdb | Предназначен для всех типов файлов; Работает с файловыми хешами.
clamav.htdb | Предназначен для HTML файлов; Работает с нормализованными HTML-данными.
clamav_regex.htdb | Предназначен для HTML файлов; Работает с нормализованными HTML-данными; Сигнатуры могут содержать регулярные выражения.
clamav.mdb | Предназначен для PE файлов; Работает с секционными метаданными PE.
clamav.ndb | Предназначен для всех типов файлов; Работает с нормализованными ANSI-данными.
clamav_regex.ndb | Предназначен для всех типов файлов; Работает с нормализованными ANSI-данными; Сигнатуры могут содержать регулярные выражения.
clamav.db | Предназначен для всех типов файлов; Работает с необработанными данными.
clamav_regex.db | Предназначен для всех типов файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_elf.db | Предназначен для ELF файлов; Работает с необработанными данными.
clamav_elf_regex.db | Предназначен для ELF файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_email.db | Предназначен для EML файлов; Работает с необработанными данными.
clamav_email_regex.db | Предназначен для EML файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_exe.db | Предназначен для PE файлов; Работает с необработанными данными.
clamav_exe_regex.db | Предназначен для PE файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_graphics.db | Предназначен для файлов изображений; Работает с необработанными данными.
clamav_graphics_regex.db | Предназначен для файлов изображений; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_java.db | Предназначен для Java файлов; Работает с необработанными данными.
clamav_java_regex.db | Предназначен для Java файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_macho.db | Предназначен для Mach-O файлов; Работает с необработанными данными.
clamav_macho_regex.db | Предназначен для Mach-O файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_ole.db | Предназначен для объектов OLE; Работает с необработанными данными.
clamav_ole_regex.db | Предназначен для объектов OLE; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_pdf.db | Предназначен для PDF файлов; Работает с необработанными данными.
clamav_pdf_regex.db | Предназначен для PDF файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.
clamav_swf.db | Предназначен для SWF файлов; Работает с необработанными данными.
clamav_swf_regex.db | Предназначен для SWF файлов; Работает с необработанными данными; Сигнатуры могут содержать регулярные выражения.

---


### Примечание относительно расширения файла сигнатуры:
*Эта информация будет расширена в будущем.*

- __cedb__: Сложные расширенные файлы сигнатуры (это домашний формат, созданный для phpMussel и не имеющий отношения к базе данных сигнатур ClamAV; SigTool не создает никаких файлов сигнатуры с использованием этого расширения; они написаны вручную для репозитория `phpMussel/Signatures`; `clamav.cedb` содержит адаптации некоторых устаревших сигнатур из предыдущих версий базы данных сигнатур ClamAV, которые, как считается, все еще сохраняют свою полезность для phpMussel). Файлы сигнатур, которые работают с различными правилами на основе расширенных метаданных, сгенерированных phpMussel, используют это расширение.
- __db__: Стандартные файлы сигнатуры (они извлекаются из файлов сигнатур `.ndb`, содержащихся в `daily.cvd` и `main.cvd`). Файлы сигнатуры, которые работают напрямую с содержимым файлов, используют это расширение.
- __fdb__: Сигнатуры для имена файлов (база данных сигнатур ClamAV ранее поддерживала сигнатуры имя файлов, но больше не поддерживает; SigTool не создает никаких файлов сигнатуры с использованием этого расширения; поддерживается благодаря постоянной полезности для phpMussel). Файлы сигнатуры, которые работают с именами файлов, используют это расширение.
- __hdb__: Сигнатуры для хэши файлов (они извлекаются из файлов сигнатур `.hdb`, содержащихся в `daily.cvd` и `main.cvd`). Файлы сигнатуры, которые работают с файловыми хешами, используют это расширение.
- __htdb__: Сигнатуры для файлов HTML (они извлекаются из файлов сигнатур `.ndb`, содержащихся в `daily.cvd` и `main.cvd`). Файлы сигнатуры, которые работают с нормализованным HTML-контентом, используют это расширение.
- __mdb__: Файлы сигнатуры для секций PE (они извлекаются из файлов сигнатур `.mdb`, содержащихся в `daily.cvd` и `main.cvd`). Файлы сигнатуры, которые работают с секционными метаданными PE, используют это расширение.
- __medb__: Файлы сигнатур расширенные PE (это домашний формат, созданный для phpMussel и не имеющий отношения к базе данных сигнатур ClamAV; SigTool не создает никаких файлов сигнатуры с использованием этого расширения; они написаны вручную для репозитория `phpMussel/Signatures`). Файлы сигнатуры, которые работают с метаданными PE (кроме метаданных секций PE), используют это расширение.
- __ndb__: Нормализованные файлы сигнатуры (они извлекаются из файлов сигнатур `.ndb`, содержащихся в `daily.cvd` и `main.cvd`). Файлы сигнатуры, которые работают с нормализованным ANSI-контентом, используют это расширение.
- __udb__: Файлы сигнатуры URL (это домашний формат, созданный для phpMussel и не имеющий отношения к базе данных сигнатур ClamAV; *В настоящее время* SigTool не создает никаких файлов сигнатуры с использованием этого расширения, хотя это может измениться в будущем; В настоящее время, они написаны вручную для репозитория `phpMussel/Signatures`). Файлы сигнатуры, которые работают с URL, используют это расширение.
- __ldb__: Файлы логической сигнатуры (однажды, для будущей версии SigTool, они будут извлечены из файлов сигнатур `.ldb`, содержащихся в `daily.cvd` и `main.cvd`, но это еще не поддерживается SigTool или phpMussel). Файлы сигнатуры, которые работают с различными логическими правилами, используют это расширение.


---


Последнее обновление: 7 Марта 2020 (2020.03.07).
